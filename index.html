<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–æ–≥–æ–¥–∞ –≤ –ö–∏—Ç–∞–µ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
        }
        h1 {
            color: white;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        .content-wrapper {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 20px;
            align-items: start;
        }
        @media (max-width: 1024px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }
        }
        .weather-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        .city-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        .city-card:hover {
            transform: translateY(-5px);
        }
        .city-name {
            font-size: 1.8em;
            color: #333;
            margin-bottom: 15px;
            font-weight: 600;
        }
        .ad-block {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 15px;
            text-align: center;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            cursor: pointer;
        }
        .ad-block:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        .ad-block a {
            color: white;
            text-decoration: none;
            display: block;
        }
        .ad-title {
            font-size: 0.85em;
            font-weight: 600;
            color: rgba(255,255,255,0.9);
            margin-bottom: 4px;
        }
        .ad-subtitle {
            font-size: 0.75em;
            color: rgba(255,255,255,0.75);
        }
        .ad-placeholder {
            background: linear-gradient(135deg, #e0e0e0 0%, #bdbdbd 100%);
            cursor: default;
        }
        .ad-placeholder:hover {
            transform: none;
            box-shadow: none;
        }
        .temp {
            font-size: 3em;
            color: #667eea;
            font-weight: bold;
            margin: 10px 0;
        }
        .description {
            font-size: 1.1em;
            color: #666;
            text-transform: capitalize;
            margin-bottom: 10px;
        }
        .feels-like {
            font-size: 0.95em;
            color: #888;
            margin-bottom: 8px;
        }
        .comfort {
            font-size: 1.05em;
            color: #764ba2;
            font-weight: 600;
            margin-bottom: 12px;
            line-height: 1.4;
        }
        .clothes-advice {
            font-size: 0.9em;
            color: #555;
            line-height: 1.6;
            background: #f8f9fa;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 3px solid #667eea;
        }
        .details {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #eee;
        }
        .detail-item {
            text-align: center;
        }
        .detail-label {
            font-size: 0.85em;
            color: #999;
            margin-bottom: 5px;
        }
        .detail-value {
            font-size: 1.1em;
            color: #333;
            font-weight: 500;
        }
        
        /* –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è –ø–æ–≥–æ–¥–∞ */
        .history-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            position: sticky;
            top: 20px;
        }
        .history-title {
            font-size: 1.5em;
            color: #333;
            margin-bottom: 20px;
            font-weight: 600;
            text-align: center;
        }
        .date-selectors {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .date-selector {
            flex: 1;
            min-width: 80px;
        }
        .date-selector label {
            display: block;
            font-size: 0.85em;
            color: #666;
            margin-bottom: 5px;
        }
        .date-selector select {
            width: 100%;
            padding: 8px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 0.95em;
            background: white;
            cursor: pointer;
            transition: border-color 0.2s;
        }
        .date-selector select:focus {
            outline: none;
            border-color: #667eea;
        }
        .city-selector {
            margin-bottom: 20px;
        }
        .city-selector label {
            display: block;
            font-size: 0.85em;
            color: #666;
            margin-bottom: 5px;
        }
        .city-selector select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            background: white;
            cursor: pointer;
            transition: border-color 0.2s;
        }
        .city-selector select:focus {
            outline: none;
            border-color: #667eea;
        }
        .history-button {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-bottom: 20px;
        }
        .history-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        .history-button:active {
            transform: translateY(0);
        }
        .history-result {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            border-left: 3px solid #667eea;
        }
        .history-result.loading {
            text-align: center;
            color: #999;
        }
        .history-result.error {
            border-left-color: #e74c3c;
            color: #e74c3c;
        }
        .history-date {
            font-size: 1.1em;
            color: #667eea;
            font-weight: 600;
            margin-bottom: 15px;
        }
        .history-temp {
            font-size: 2em;
            color: #667eea;
            font-weight: bold;
            margin: 10px 0;
        }
        .history-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }
        .history-detail-item {
            font-size: 0.9em;
            color: #666;
        }
        .history-detail-label {
            font-weight: 600;
            color: #333;
        }
        
        .loading {
            text-align: center;
            color: white;
            font-size: 1.2em;
        }
        .error {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            color: #e74c3c;
        }
        .update-time {
            text-align: center;
            color: rgba(255,255,255,0.8);
            margin-top: 20px;
            font-size: 0.9em;
        }
        .data-source {
            text-align: center;
            color: rgba(255,255,255,0.7);
            margin-top: 8px;
            font-size: 0.85em;
        }
        .data-source a {
            color: rgba(255,255,255,0.9);
            text-decoration: none;
            border-bottom: 1px solid rgba(255,255,255,0.4);
        }
        .data-source a:hover {
            color: white;
            border-bottom-color: white;
        }
    </style>
</head>
<body>
    <div class="main-container">
        <h1>üå§Ô∏è –ü–æ–≥–æ–¥–∞ –≤ –ö–∏—Ç–∞–µ</h1>
        
        <div class="content-wrapper">
            <div>
                <div id="weather-container" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–≥–æ–¥—ã...</div>
                <div class="update-time" id="update-time"></div>
                <div class="data-source" id="data-source"></div>
            </div>
            
            <div class="history-card">
                <div class="history-title">üìÖ –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è –ø–æ–≥–æ–¥–∞</div>
                
                <div class="city-selector">
                    <label>–ì–æ—Ä–æ–¥:</label>
                    <select id="history-city">
                        <option value="0">–ü–µ–∫–∏–Ω</option>
                        <option value="1">–®–∞–Ω—Ö–∞–π</option>
                        <option value="2">–ì—É–∞–Ω—á–∂–æ—É</option>
                    </select>
                </div>
                
                <div class="date-selectors">
                    <div class="date-selector">
                        <label>–ì–æ–¥:</label>
                        <select id="history-year"></select>
                    </div>
                    <div class="date-selector">
                        <label>–ú–µ—Å—è—Ü:</label>
                        <select id="history-month">
                            <option value="1">–Ø–Ω–≤–∞—Ä—å</option>
                            <option value="2">–§–µ–≤—Ä–∞–ª—å</option>
                            <option value="3">–ú–∞—Ä—Ç</option>
                            <option value="4">–ê–ø—Ä–µ–ª—å</option>
                            <option value="5">–ú–∞–π</option>
                            <option value="6">–ò—é–Ω—å</option>
                            <option value="7">–ò—é–ª—å</option>
                            <option value="8">–ê–≤–≥—É—Å—Ç</option>
                            <option value="9">–°–µ–Ω—Ç—è–±—Ä—å</option>
                            <option value="10">–û–∫—Ç—è–±—Ä—å</option>
                            <option value="11">–ù–æ—è–±—Ä—å</option>
                            <option value="12">–î–µ–∫–∞–±—Ä—å</option>
                        </select>
                    </div>
                    <div class="date-selector">
                        <label>–î–µ–Ω—å:</label>
                        <select id="history-day"></select>
                    </div>
                </div>
                
                <button class="history-button" onclick="loadHistoricalWeather()">
                    üîç –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–≥–æ–¥—É
                </button>
                
                <div id="history-result" class="history-result" style="display: none;">
                    <div class="history-date" id="history-result-date"></div>
                    <div class="history-temp" id="history-result-temp"></div>
                    <div class="description" id="history-result-desc"></div>
                    <div class="history-details">
                        <div class="history-detail-item">
                            <span class="history-detail-label">–ú–∞–∫—Å:</span>
                            <span id="history-max-temp"></span>
                        </div>
                        <div class="history-detail-item">
                            <span class="history-detail-label">–ú–∏–Ω:</span>
                            <span id="history-min-temp"></span>
                        </div>
                        <div class="history-detail-item">
                            <span class="history-detail-label">–í–µ—Ç–µ—Ä:</span>
                            <span id="history-wind"></span>
                        </div>
                        <div class="history-detail-item">
                            <span class="history-detail-label">–û—Å–∞–¥–∫–∏:</span>
                            <span id="history-rain"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const cities = [
            { name: '–ü–µ–∫–∏–Ω', lat: 39.9042, lon: 116.4074, climate: 'continental' },
            { name: '–®–∞–Ω—Ö–∞–π', lat: 31.2304, lon: 121.4737, climate: 'humid_subtropical' },
            { name: '–ì—É–∞–Ω—á–∂–æ—É', lat: 23.1291, lon: 113.2644, climate: 'tropical' }
        ];

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ –¥–∞—Ç—ã
        function initializeDateSelectors() {
            const yearSelect = document.getElementById('history-year');
            const daySelect = document.getElementById('history-day');
            const currentYear = new Date().getFullYear();
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º –≥–æ–¥—ã (—Å 1940 –ø–æ —Ç–µ–∫—É—â–∏–π –≥–æ–¥)
            for (let year = currentYear; year >= 1940; year--) {
                const option = document.createElement('option');
                option.value = year;
                option.textContent = year;
                yearSelect.appendChild(option);
            }
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º –¥–Ω–∏
            updateDays();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–Ω–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –º–µ—Å—è—Ü–∞ –∏–ª–∏ –≥–æ–¥–∞
            document.getElementById('history-month').addEventListener('change', updateDays);
            document.getElementById('history-year').addEventListener('change', updateDays);
        }

        function updateDays() {
            const daySelect = document.getElementById('history-day');
            const month = parseInt(document.getElementById('history-month').value);
            const year = parseInt(document.getElementById('history-year').value);
            
            const daysInMonth = new Date(year, month, 0).getDate();
            const currentDay = daySelect.value;
            
            daySelect.innerHTML = '';
            for (let day = 1; day <= daysInMonth; day++) {
                const option = document.createElement('option');
                option.value = day;
                option.textContent = day;
                daySelect.appendChild(option);
            }
            
            if (currentDay && currentDay <= daysInMonth) {
                daySelect.value = currentDay;
            }
        }

        async function getWeather(city) {
            const url = `https://api.open-meteo.com/v1/forecast?latitude=${city.lat}&longitude=${city.lon}&current=temperature_2m,apparent_temperature,relative_humidity_2m,wind_speed_10m,weather_code&timezone=Asia/Shanghai`;
            
            const response = await fetch(url);
            const data = await response.json();
            
            const weatherCodes = {
                0: '‚òÄÔ∏è –Ø—Å–Ω–æ',
                1: 'üå§Ô∏è –ú–∞–ª–æ–æ–±–ª–∞—á–Ω–æ',
                2: '‚õÖ –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å',
                3: '‚òÅÔ∏è –û–±–ª–∞—á–Ω–æ',
                45: 'üå´Ô∏è –¢—É–º–∞–Ω',
                48: 'üå´Ô∏è –ò–∑–º–æ—Ä–æ–∑—å',
                51: 'üå¶Ô∏è –ù–µ–±–æ–ª—å—à–∞—è –º–æ—Ä–æ—Å—å',
                53: 'üå¶Ô∏è –ú–æ—Ä–æ—Å—å',
                55: 'üåßÔ∏è –°–∏–ª—å–Ω–∞—è –º–æ—Ä–æ—Å—å',
                61: 'üåßÔ∏è –ù–µ–±–æ–ª—å—à–æ–π –¥–æ–∂–¥—å',
                63: 'üåßÔ∏è –î–æ–∂–¥—å',
                65: '‚õàÔ∏è –°–∏–ª—å–Ω—ã–π –¥–æ–∂–¥—å',
                71: 'üå®Ô∏è –ù–µ–±–æ–ª—å—à–æ–π —Å–Ω–µ–≥',
                73: '‚ùÑÔ∏è –°–Ω–µ–≥',
                75: '‚ùÑÔ∏è –°–∏–ª—å–Ω—ã–π —Å–Ω–µ–≥',
                95: '‚õàÔ∏è –ì—Ä–æ–∑–∞'
            };
            
            return {
                name: city.name,
                temp: Math.round(data.current.temperature_2m),
                feelsLike: Math.round(data.current.apparent_temperature),
                humidity: data.current.relative_humidity_2m,
                wind: data.current.wind_speed_10m,
                description: weatherCodes[data.current.weather_code] || 'üåç –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                climate: city.climate
            };
        }

        async function loadHistoricalWeather() {
            const resultDiv = document.getElementById('history-result');
            const cityIndex = parseInt(document.getElementById('history-city').value);
            const year = document.getElementById('history-year').value;
            const month = document.getElementById('history-month').value.padStart(2, '0');
            const day = document.getElementById('history-day').value.padStart(2, '0');
            
            const date = `${year}-${month}-${day}`;
            const city = cities[cityIndex];
            
            resultDiv.style.display = 'block';
            resultDiv.className = 'history-result loading';
            resultDiv.innerHTML = '‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...';
            
            try {
                const url = `https://archive-api.open-meteo.com/v1/archive?latitude=${city.lat}&longitude=${city.lon}&start_date=${date}&end_date=${date}&daily=temperature_2m_max,temperature_2m_min,temperature_2m_mean,precipitation_sum,wind_speed_10m_max,weather_code&timezone=Asia/Shanghai`;
                
                const response = await fetch(url);
                const data = await response.json();
                
                if (!data.daily || !data.daily.temperature_2m_mean[0]) {
                    throw new Error('–î–∞–Ω–Ω—ã–µ –∑–∞ —ç—Ç—É –¥–∞—Ç—É –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã');
                }
                
                const weatherCodes = {
                    0: '‚òÄÔ∏è –Ø—Å–Ω–æ',
                    1: 'üå§Ô∏è –ú–∞–ª–æ–æ–±–ª–∞—á–Ω–æ',
                    2: '‚õÖ –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å',
                    3: '‚òÅÔ∏è –û–±–ª–∞—á–Ω–æ',
                    45: 'üå´Ô∏è –¢—É–º–∞–Ω',
                    48: 'üå´Ô∏è –ò–∑–º–æ—Ä–æ–∑—å',
                    51: 'üå¶Ô∏è –ù–µ–±–æ–ª—å—à–∞—è –º–æ—Ä–æ—Å—å',
                    53: 'üå¶Ô∏è –ú–æ—Ä–æ—Å—å',
                    55: 'üåßÔ∏è –°–∏–ª—å–Ω–∞—è –º–æ—Ä–æ—Å—å',
                    61: 'üåßÔ∏è –ù–µ–±–æ–ª—å—à–æ–π –¥–æ–∂–¥—å',
                    63: 'üåßÔ∏è –î–æ–∂–¥—å',
                    65: '‚õàÔ∏è –°–∏–ª—å–Ω—ã–π –¥–æ–∂–¥—å',
                    71: 'üå®Ô∏è –ù–µ–±–æ–ª—å—à–æ–π —Å–Ω–µ–≥',
                    73: '‚ùÑÔ∏è –°–Ω–µ–≥',
                    75: '‚ùÑÔ∏è –°–∏–ª—å–Ω—ã–π —Å–Ω–µ–≥',
                    95: '‚õàÔ∏è –ì—Ä–æ–∑–∞'
                };
                
                resultDiv.className = 'history-result';
                
                const avgTemp = Math.round(data.daily.temperature_2m_mean[0]);
                const maxTemp = Math.round(data.daily.temperature_2m_max[0]);
                const minTemp = Math.round(data.daily.temperature_2m_min[0]);
                const wind = Math.round(data.daily.wind_speed_10m_max[0] * 10) / 10;
                const rain = data.daily.precipitation_sum[0] || 0;
                const weatherCode = data.daily.weather_code[0];
                
                const dateObj = new Date(date);
                const formattedDate = dateObj.toLocaleDateString('ru-RU', { 
                    day: 'numeric', 
                    month: 'long', 
                    year: 'numeric' 
                });
                
                resultDiv.innerHTML = `
                    <div class="history-date">${city.name}, ${formattedDate}</div>
                    <div class="history-temp">${avgTemp}¬∞C</div>
                    <div class="description">${weatherCodes[weatherCode] || 'üåç –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</div>
                    <div class="history-details">
                        <div class="history-detail-item">
                            <span class="history-detail-label">–ú–∞–∫—Å:</span> ${maxTemp}¬∞C
                        </div>
                        <div class="history-detail-item">
                            <span class="history-detail-label">–ú–∏–Ω:</span> ${minTemp}¬∞C
                        </div>
                        <div class="history-detail-item">
                            <span class="history-detail-label">–í–µ—Ç–µ—Ä:</span> ${wind} –∫–º/—á
                        </div>
                        <div class="history-detail-item">
                            <span class="history-detail-label">–û—Å–∞–¥–∫–∏:</span> ${rain} –º–º
                        </div>
                    </div>
                `;
                
            } catch (error) {
                resultDiv.className = 'history-result error';
                resultDiv.innerHTML = `‚ùå ${error.message}`;
            }
        }

        function getWeatherAdvice(data) {
            const { feelsLike, humidity, wind, climate } = data;
            
            let adjustedFeels = feelsLike;
            
            if (climate === 'continental') {
                if (feelsLike < 15 && wind > 15) {
                    adjustedFeels -= 3;
                }
                if (feelsLike < 5) {
                    adjustedFeels -= 2;
                }
            }
            
            if (climate === 'humid_subtropical') {
                if (humidity > 70) {
                    if (feelsLike < 15) {
                        adjustedFeels -= 4;
                    } else if (feelsLike > 28) {
                        adjustedFeels += 3;
                    }
                }
            }
            
            if (climate === 'tropical') {
                if (humidity > 75 && feelsLike > 25) {
                    adjustedFeels += 4;
                }
            }
            
            let feeling = '';
            let clothes = '';
            
            if (adjustedFeels < -10) {
                feeling = 'ü•∂ –û—á–µ–Ω—å —Ö–æ–ª–æ–¥–Ω–æ - –ø—Ä–æ–Ω–∏–∑—ã–≤–∞—é—â–∏–π –º–æ—Ä–æ–∑';
                clothes = '–¢—è–∂—ë–ª—ã–π –ø—É—Ö–æ–≤–∏–∫, —Ç–µ—Ä–º–æ–±–µ–ª—å—ë, —à–∞–ø–∫–∞-—É—à–∞–Ω–∫–∞, —à–∞—Ä—Ñ –Ω–∞ –ª–∏—Ü–æ, –ø–µ—Ä—á–∞—Ç–∫–∏ –∏ —É—Ç–µ–ø–ª—ë–Ω–Ω—ã–µ –±–æ—Ç–∏–Ω–∫–∏. –ù–µ —Å—Ç–æ–π—Ç–µ –¥–æ–ª–≥–æ –Ω–∞ —É–ª–∏—Ü–µ!';
            } else if (adjustedFeels < 0) {
                feeling = '‚ùÑÔ∏è –•–æ–ª–æ–¥–Ω–æ - –º–æ—Ä–æ–∑ —á—É–≤—Å—Ç–≤—É–µ—Ç—Å—è';
                if (climate === 'continental') {
                    clothes = '–ó–∏–º–Ω—è—è –∫—É—Ä—Ç–∫–∞, —Ç—ë–ø–ª—ã–π —Å–≤–∏—Ç–µ—Ä, —à–∞–ø–∫–∞, —à–∞—Ä—Ñ –∏ –ø–µ—Ä—á–∞—Ç–∫–∏. –°—É—Ö–æ–π –≤–æ–∑–¥—É—Ö - –≥—É–±—ã –∏ —Ä—É–∫–∏ —Å–æ—Ö–Ω—É—Ç, –±–µ—Ä–∏—Ç–µ –±–∞–ª—å–∑–∞–º!';
                } else {
                    clothes = '–ü—É—Ö–æ–≤–∏–∫, —à–∞–ø–∫–∞, —à–∞—Ä—Ñ –∏ –ø–µ—Ä—á–∞—Ç–∫–∏. –í–ª–∞–∂–Ω–æ—Å—Ç—å –¥–µ–ª–∞–µ—Ç —Ö–æ–ª–æ–¥ –ø—Ä–æ–Ω–∏–∑—ã–≤–∞—é—â–∏–º - –æ–¥–µ–≤–∞–π—Ç–µ—Å—å —Ç–µ–ø–ª–µ–µ!';
                }
            } else if (adjustedFeels < 10) {
                feeling = 'üß• –ü—Ä–æ—Ö–ª–∞–¥–Ω–æ - –ø—Ä–æ–±–∏—Ä–∞–µ—Ç';
                if (climate === 'continental' || climate === 'humid_subtropical') {
                    clothes = '–¢—ë–ø–ª–∞—è –∫—É—Ä—Ç–∫–∞ –∏–ª–∏ –ø–∞–ª—å—Ç–æ, —Å–≤–∏—Ç–µ—Ä, –¥–∂–∏–Ω—Å—ã. –í–ª–∞–∂–Ω–æ—Å—Ç—å –º–æ–∂–µ—Ç –ø—Ä–æ–Ω–∏–∫–∞—Ç—å –ø–æ–¥ –æ–¥–µ–∂–¥—É - –æ–¥–µ–≤–∞–π—Ç–µ—Å—å —Å–ª–æ—è–º–∏!';
                } else {
                    clothes = '–õ—ë–≥–∫–∞—è –∫—É—Ä—Ç–∫–∞, –∫–æ—Ñ—Ç–∞. –í —Ç—Ä–æ–ø–∏–∫–∞—Ö —ç—Ç–æ —Ä–µ–¥–∫–æ—Å—Ç—å - –Ω–∞—Å–ª–∞–∂–¥–∞–π—Ç–µ—Å—å –ø—Ä–æ—Ö–ª–∞–¥–æ–π!';
                }
            } else if (adjustedFeels < 18) {
                feeling = 'üòä –ö–æ–º—Ñ–æ—Ä—Ç–Ω–æ - –ø—Ä–∏—è—Ç–Ω–∞—è –ø–æ–≥–æ–¥–∞';
                clothes = '–õ—ë–≥–∫–∞—è –∫–æ—Ñ—Ç–∞ –∏–ª–∏ —Ä—É–±–∞—à–∫–∞ —Å –¥–ª–∏–Ω–Ω—ã–º —Ä—É–∫–∞–≤–æ–º, –¥–∂–∏–Ω—Å—ã. –ò–¥–µ–∞–ª—å–Ω–∞—è –ø–æ–≥–æ–¥–∞ –¥–ª—è –ø—Ä–æ–≥—É–ª–æ–∫!';
            } else if (adjustedFeels < 25) {
                feeling = 'üå°Ô∏è –¢–µ–ø–ª–æ - –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ';
                if (humidity > 70) {
                    clothes = '–§—É—Ç–±–æ–ª–∫–∞, –ª—ë–≥–∫–∏–µ –±—Ä—é–∫–∏ –∏–ª–∏ —à–æ—Ä—Ç—ã. –í–ª–∞–∂–Ω–æ—Å—Ç—å –æ—â—É—â–∞–µ—Ç—Å—è - –±–µ—Ä–∏—Ç–µ –≤–æ–¥—É!';
                } else {
                    clothes = '–§—É—Ç–±–æ–ª–∫–∞, –¥–∂–∏–Ω—Å—ã –∏–ª–∏ –ª—ë–≥–∫–∏–µ –±—Ä—é–∫–∏. –ü—Ä–∏—è—Ç–Ω–∞—è —Ç—ë–ø–ª–∞—è –ø–æ–≥–æ–¥–∞!';
                }
            } else if (adjustedFeels < 32) {
                feeling = 'üî• –ñ–∞—Ä–∫–æ - –¥—É—Ö–æ—Ç–∞ —á—É–≤—Å—Ç–≤—É–µ—Ç—Å—è';
                if (climate === 'tropical' || climate === 'humid_subtropical') {
                    clothes = '–õ—ë–≥–∫–∞—è –¥—ã—à–∞—â–∞—è –æ–¥–µ–∂–¥–∞, —à–æ—Ä—Ç—ã, —Å–∞–Ω–¥–∞–ª–∏–∏. –í–ª–∞–∂–Ω–æ—Å—Ç—å –≤—ã—Å–æ–∫–∞—è - –∫–∞–∫ –≤ –±–∞–Ω–µ! –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –±–µ—Ä–∏—Ç–µ –≤–æ–¥—É, –∑–æ–Ω—Ç –æ—Ç —Å–æ–ª–Ω—Ü–∞ –∏ –∏—â–∏—Ç–µ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä—ã.';
                } else {
                    clothes = '–§—É—Ç–±–æ–ª–∫–∞, —à–æ—Ä—Ç—ã, –≥–æ–ª–æ–≤–Ω–æ–π —É–±–æ—Ä. –°—É—Ö–∞—è –∂–∞—Ä–∞ - –ø–µ–π—Ç–µ –º–Ω–æ–≥–æ –≤–æ–¥—ã –∏ –±–µ—Ä–∏—Ç–µ —Å–æ–ª–Ω—Ü–µ–∑–∞—â–∏—Ç–Ω—ã–π –∫—Ä–µ–º!';
                }
            } else {
                feeling = '‚ô®Ô∏è –û—á–µ–Ω—å –∂–∞—Ä–∫–æ - —Ç—Ä–æ–ø–∏—á–µ—Å–∫–æ–µ –ø–µ–∫–ª–æ';
                if (climate === 'tropical' || climate === 'humid_subtropical') {
                    clothes = '–ú–∏–Ω–∏–º—É–º –ª—ë–≥–∫–æ–π –æ–¥–µ–∂–¥—ã –∏–∑ –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã—Ö —Ç–∫–∞–Ω–µ–π. –í–ª–∞–∂–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–µ–¥–µ–ª—å–Ω–∞—è - –¥—ã—à–∞—Ç—å —Ç—è–∂–µ–ª–æ! –ü–æ—Å—Ç–æ—è–Ω–Ω–æ –ø–µ–π—Ç–µ –≤–æ–¥—É, –∏—â–∏—Ç–µ —Ç–µ–Ω—å –∏ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä—ã. –ë–µ–∑ –∫—Ä–∞–π–Ω–µ–π –Ω—É–∂–¥—ã –ª—É—á—à–µ –Ω–µ –≤—ã—Ö–æ–¥–∏—Ç—å.';
                } else {
                    clothes = '–õ—ë–≥–∫–∞—è –æ–¥–µ–∂–¥–∞, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≥–æ–ª–æ–≤–Ω–æ–π —É–±–æ—Ä. –≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–∞—è –∂–∞—Ä–∞ - –∏–∑–±–µ–≥–∞–π—Ç–µ —Å–æ–ª–Ω—Ü–∞ —Å 11 –¥–æ 16 —á–∞—Å–æ–≤!';
                }
            }
            
            return { feeling, clothes };
        }

        async function displayWeather() {
            const container = document.getElementById('weather-container');
            const updateTime = document.getElementById('update-time');
            const dataSource = document.getElementById('data-source');
            
            try {
                const weatherData = await Promise.all(cities.map(city => getWeather(city)));
                
                container.className = 'weather-grid';
                container.innerHTML = weatherData.map((data, index) => {
                    const advice = getWeatherAdvice(data);
                    
                    let adBlock = '';
                    if (index === 0) {
                        adBlock = `
                            <div class="ad-block">
                                <a href="https://zgcvpn.com/" target="_blank" rel="noopener noreferrer">
                                    <div class="ad-title">üîí –ù—É–∂–µ–Ω VPN –≤ –ö–∏—Ç–∞–µ?</div>
                                    <div class="ad-subtitle">ZGC VPN - –Ω–∞–¥—ë–∂–Ω—ã–π –¥–æ—Å—Ç—É–ø ‚Üí</div>
                                </a>
                            </div>
                        `;
                    } else {
                        adBlock = `
                            <div class="ad-block ad-placeholder">
                                <div class="ad-title">üì¢ –¢—É—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å</div>
                                <div class="ad-subtitle">–≤–∞—à–∞ —Ä–µ–∫–ª–∞–º–∞</div>
                            </div>
                        `;
                    }
                    
                    return `
                    <div class="city-card">
                        <div class="city-name">${data.name}</div>
                        ${adBlock}
                        <div class="temp">${data.temp}¬∞C</div>
                        <div class="description">${data.description}</div>
                        <div class="feels-like">–û—â—É—â–∞–µ—Ç—Å—è –∫–∞–∫ ${data.feelsLike}¬∞C</div>
                        <div class="comfort">${advice.feeling}</div>
                        <div class="clothes-advice">${advice.clothes}</div>
                        <div class="details">
                            <div class="detail-item">
                                <div class="detail-label">–í–ª–∞–∂–Ω–æ—Å—Ç—å</div>
                                <div class="detail-value">${data.humidity}%</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">–í–µ—Ç–µ—Ä</div>
                                <div class="detail-value">${data.wind} –∫–º/—á</div>
                            </div>
                        </div>
                    </div>
                `;
                }).join('');
                
                const now = new Date().toLocaleString('ru-RU', { 
                    timeZone: 'Asia/Shanghai',
                    hour: '2-digit',
                    minute: '2-digit',
                    day: '2-digit',
                    month: '2-digit',
                    year: 'numeric'
                });
                updateTime.textContent = `–û–±–Ω–æ–≤–ª–µ–Ω–æ: ${now} (–≤—Ä–µ–º—è –ö–∏—Ç–∞—è)`;
                dataSource.innerHTML = `–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö: <a href="https://open-meteo.com/" target="_blank" rel="noopener noreferrer">Open-Meteo.com</a>`;
                
            } catch (error) {
                container.className = 'error';
                container.innerHTML = `<p>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö: ${error.message}</p>`;
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        initializeDateSelectors();
        displayWeather();
        setInterval(displayWeather, 600000);
    </script>
</body>
</html>
